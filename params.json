{"name":"Ms-hook-c","tagline":"A memory scanner which can be used to dynamically look up and hook private code within iOS binaries. The scanner also works on OSX too however the mechanism for hooking is different. For iOS, please use Theos.","body":"#Hooking Private Code on iOS/OSX\r\n\r\nAs far as the scanner is concerned, I'm finished with it. I'm going to do a final sweep and remove superfluous code and then I'll land the final commit.\r\nThe scanner currently works on both iOS and OSX however the technique for hooking is iOS only.\r\nYou can hook code on OSX easily so I won't be covering it here.\r\n\r\nContact: `wiresharkGD@gmail.com` || `@Hexploitable`\r\n\r\n##Instructions\r\n\r\n1. Open app in disassembler, grab first ~16 bytes (customise this as you will) of target method and use as signature with scanner.\r\n\r\n2. Run the scanner against the target process. It will locate the signature in memory and print it's address. The signature has to be passed in as bytes, not a literal string so use the scanner as shown:\r\n\r\n\t\t./scanner <pid> $'<signature>'\r\ne.g:\r\n\t\t./scanner 1337 $'\\xDE\\xAD\\xBE\\xEF'\r\n\r\n3. Use the returned address in Tweak.xm to hook it.\r\n\t-\tIf ASLR/PIE is enabled - simply get the address of an import too, calculate the offset and then modify Tweak.xm to use an offset instead of a hardcoded address, this way you can hook it, knowing it'll work 100% of the time. \r\n\r\n4. You will now need to set the binary's entitlements appropriately:\r\n\r\n\t\tldid -Sentitlements.xml <scanner binary>\r\n\r\n5. Inject your library into the process as you normally would:\r\n\r\n\t\tDYLD_INSERT_LIBRARIES=/Library/MobileSubstrate/DynamicLibraries/<lib>.dylib ./<binary>","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}