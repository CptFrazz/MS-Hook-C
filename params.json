{"name":"Ms-hook-c","tagline":"A memory scanner which can be used to dynamically look up and hook private code within iOS binaries. The scanner also works on OSX too however the mechanism for hooking is different. For iOS, please use Theos.","body":"#Hooking Private Code from Stripped iOS Binaries\r\n\r\nAs far as the scanner is concerned, I'm finished with it. I'm going to do a final sweep and remove superfluous code and then I'll land the final commit.\r\n\r\nContact: `wiresharkGD@gmail.com` || `@Hexploitable`\r\n\r\n##Instructions\r\n\r\n1. Open your target app in a disassembler, grab first ~16 bytes (customise this as you will) of the method you want to hook and then use these as the signature with the scanner.\r\n\r\n2. Compile the scanner and then set the binary's entitlements appropriately:\r\n\r\n\t\tldid -Sentitlements.xml <scanner binary>\r\n3. Write the needle to a file:\r\n\r\n\t\techo -n -e '\\x55\\x48\\x89\\xE5\\xB8\\x15\\x00\\x00\\x00\\x5D' > hex\r\n\r\n4. Run the scanner against the target process. It will locate the signature in memory and print it's address. The signature has to be passed in as bytes, not a literal string so use the scanner as shown:\r\n\r\n\t\tsudo ./scanner <pid> <Path to file containing needle>\r\ne.g:\r\n\r\n\t\tsudo ./scanner 1337 ./hex\r\n\r\n5. Use the returned address in Tweak.xm to hook it.\r\n\t-\tIf ASLR/PIE is enabled - simply get the address of an import too, calculate the offset and then modify Tweak.xm to use an offset instead of a hardcoded address, this way you can hook it, knowing it'll work 100% of the time. \r\n\r\n\r\n6. Inject your library into the process as you normally would:\r\n\r\n\t\tDYLD_INSERT_LIBRARIES=/Library/MobileSubstrate/DynamicLibraries/<libName>.dylib ./<binary>\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}